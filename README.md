# Платформа торговой сети электроники

## Описание проекта

Данный проект представляет собой backend-часть для платформы торговой сети электроники. Реализован с использованием Django и Django REST Framework (DRF), предоставляя API для управления иерархической структурой сети и админ-панель для управления данными.

## Основные функции

- **Иерархическая структура сети**:
  - 3 уровня: завод, розничная сеть, индивидуальный предприниматель
  - Гибкие связи между элементами сети
- **Управление элементами сети**:
  - CRUD операции для всех типов звеньев сети
  - Автоматическое определение уровня иерархии
- **Управление продуктами**:
  - Привязка продуктов к элементам сети
  - Учет даты выхода продукта на рынок
- **Административные функции**:
  - Просмотр и редактирование объектов в админ-панели
  - Очистка задолженности перед поставщиком
  - Фильтрация по городу
- **API функции**:
  - Полноценный CRUD для поставщиков
  - Фильтрация по стране
  - Контроль доступа для сотрудников

## Технологии

- Python 3.8+
- Django 3+
- Django REST Framework 3.10+
- PostgreSQL 10+
- Gunicorn
- Docker
- drf-spectacular (для API документации)
- django-filter
- Coverage (для анализа покрытия кода тестами)
- Loguru (для улучшенного логирования)

## Модели

### Модель звена сети (NetworkNode)
- `name` — название звена сети
- `node_type` — тип звена (завод, розничная сеть, ИП)
- `email` — электронная почта
- `country` — страна
- `city` — город
- `street` — улица
- `house_number` — номер дома
- `supplier` — ссылка на поставщика (ForeignKey)
- `debt_to_supplier` — задолженность перед поставщиком (Decimal)
- `created_at` — время создания (auto_now_add)
- `level` — уровень иерархии (вычисляемое поле)

### Модель продукта (Product)
- `name` — название продукта
- `model` — модель продукта
- `release_date` — дата выхода на рынок
- `network_node` — звено сети, которому принадлежит продукт (ForeignKey)

## Права доступа

- **Анонимные пользователи**: 
  - Доступ запрещен
- **Активные сотрудники**:
  - Полный доступ к API (CRUD операции)
- **Администраторы**:
  - Полный доступ через админ-панель
  - Доступ к специальным действиям (очистка задолженности)

## Установка и настройка

### 1. Установка зависимостей

Убедитесь, что у вас установлен Python версии 3.8+. Для установки зависимостей:

```bash
pip install -r requirements.txt
```

### 2. Настройка переменных окружения

Скопируйте файл `.env.example` в `.env`:

```bash
cp .env.example .env
```

Заполните файл `.env` необходимыми значениями.

### 3. Запуск сервера разработки

```bash
python manage.py migrate
python manage.py runserver
```

## Запуск с использованием Docker

Убедитесь, что у вас установлены Docker и Docker Compose.

```bash
docker-compose up -d --build
```

Приложение будет доступно по адресу http://localhost:8000.

## API Документация

Документация API доступна по адресу `/swagger/` или `/redoc/` после запуска сервера.

## Админ-панель

Админ-панель доступна по адресу `/admin/`. Особенности админ-панели:

- Ссылка на поставщика для каждого объекта
- Фильтр по названию города
- Admin action для очистки задолженности
- Удобное отображение иерархии сети

## Тестирование

Для запуска тестов используйте:

```bash
python manage.py test
```

Текущее покрытие тестами составляет 95% кода проекта.

## Особенности реализации

1. **Гибкая иерархия сети**:
   - Уровень иерархии вычисляется автоматически
   - Возможность создания любых связей между элементами

2. **Контроль задолженности**:
   - Запрет на обновление через API
   - Возможность очистки через админ-панель

3. **Безопасность**:
   - Доступ к API только для активных сотрудников
   - Валидация данных на нескольких уровнях

4. **Удобство администрирования**:
   - Специальные фильтры и действия в админ-панели
   - Наглядное отображение связей

## Автор

Telegram @eslobodyanik